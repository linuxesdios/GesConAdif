#!/usr/bin/env python3
"""
Sistema de Ayuda Integrado para Generador de Actas ADIF
Ventana completa de documentaci√≥n y gu√≠as de uso
"""
import sys
import os
from PyQt5.QtWidgets import *
from PyQt5.QtCore import *
from PyQt5.QtGui import *
import logging

logger = logging.getLogger(__name__)

class VentanaAyuda(QDialog):
    """Ventana de ayuda completa con documentaci√≥n integrada"""
    
    def __init__(self, parent=None):
        super().__init__(parent)
        self.setWindowTitle("üìã Gu√≠a Completa - Generador de Actas ADIF")
        self.setWindowIcon(self._get_app_icon())
        self.setup_ui()
        self.cargar_contenido()
        
        # Configurar ventana
        self.resize(1000, 700)
        self.setModal(False)  # Permitir que funcione junto con la aplicaci√≥n principal
        
    def _get_app_icon(self):
        """Obtener icono de la aplicaci√≥n"""
        try:
            if hasattr(sys, '_MEIPASS'):
                icono_path = os.path.join(sys._MEIPASS, 'images', 'icono.ico')
            else:
                icono_path = 'images/icono.ico'
            
            if os.path.exists(icono_path):
                return QIcon(icono_path)
        except Exception as e:
            logger.debug(f"Error cargando icono ayuda: {e}")
        
        return QIcon()
    
    def setup_ui(self):
        """Configurar interfaz de usuario"""
        layout = QVBoxLayout(self)
        
        # Header con logo y t√≠tulo
        self.create_header(layout)
        
        # Pesta√±as principales
        self.tab_widget = QTabWidget()
        layout.addWidget(self.tab_widget)
        
        # Crear pesta√±as
        self.create_tabs()
        
        # Botones inferiores
        self.create_bottom_buttons(layout)
    
    def create_header(self, layout):
        """Crear header de la ventana"""
        header_frame = QFrame()
        header_frame.setStyleSheet("""
            QFrame {
                background: qlineargradient(x1: 0, y1: 0, x2: 1, y2: 0,
                    stop: 0 #0066CC, stop: 1 #004499);
                border-radius: 10px;
                margin-bottom: 10px;
            }
        """)
        header_frame.setMaximumHeight(120)
        
        header_layout = QHBoxLayout(header_frame)
        
        # Logo (si est√° disponible)
        try:
            if hasattr(sys, '_MEIPASS'):
                logo_path = os.path.join(sys._MEIPASS, 'images', 'adif.png')
            else:
                logo_path = 'images/adif.png'
            
            if os.path.exists(logo_path):
                logo_label = QLabel()
                pixmap = QPixmap(logo_path).scaled(60, 60, Qt.KeepAspectRatio, Qt.SmoothTransformation)
                logo_label.setPixmap(pixmap)
                header_layout.addWidget(logo_label)
        except:
            pass
        
        # T√≠tulo y subt√≠tulo
        title_layout = QVBoxLayout()
        
        title_label = QLabel("üìã Gu√≠a Completa - Generador de Actas ADIF")
        title_label.setStyleSheet("""
            color: white;
            font-size: 18px;
            font-weight: bold;
            margin: 5px;
        """)
        
        subtitle_label = QLabel("Sistema integral de gesti√≥n de contratos y documentos oficiales")
        subtitle_label.setStyleSheet("""
            color: #E6F3FF;
            font-size: 12px;
            margin: 5px;
        """)
        
        title_layout.addWidget(title_label)
        title_layout.addWidget(subtitle_label)
        
        header_layout.addLayout(title_layout)
        header_layout.addStretch()
        
        # Versi√≥n
        version_label = QLabel("v3.2")
        version_label.setStyleSheet("""
            color: white;
            font-size: 14px;
            font-weight: bold;
            margin: 10px;
        """)
        header_layout.addWidget(version_label)
        
        layout.addWidget(header_frame)
    
    def create_tabs(self):
        """Crear todas las pesta√±as de ayuda"""
        # 1. Inicio R√°pido
        self.tab_inicio = self.create_scroll_tab()
        self.tab_widget.addTab(self.tab_inicio, "üöÄ Inicio R√°pido")
        
        # 2. Gesti√≥n de Contratos
        self.tab_contratos = self.create_scroll_tab()
        self.tab_widget.addTab(self.tab_contratos, "üèóÔ∏è Contratos")
        
        # 3. Generaci√≥n de Documentos
        self.tab_documentos = self.create_scroll_tab()
        self.tab_widget.addTab(self.tab_documentos, "üìÑ Documentos")
        
        # 4. Facturas Directas
        self.tab_facturas = self.create_scroll_tab()
        self.tab_widget.addTab(self.tab_facturas, "üí∞ Facturas Directas")
        
        # 5. Seguimiento y Reportes
        self.tab_seguimiento = self.create_scroll_tab()
        self.tab_widget.addTab(self.tab_seguimiento, "üìä Seguimiento")
        
        # 6. Soluci√≥n de Problemas
        self.tab_problemas = self.create_scroll_tab()
        self.tab_widget.addTab(self.tab_problemas, "üîß Problemas")
        
        # 7. Acerca de
        self.tab_acerca = self.create_scroll_tab()
        self.tab_widget.addTab(self.tab_acerca, "‚ÑπÔ∏è Acerca de")
    
    def create_scroll_tab(self):
        """Crear una pesta√±a con scroll"""
        scroll_area = QScrollArea()
        scroll_area.setWidgetResizable(True)
        scroll_area.setHorizontalScrollBarPolicy(Qt.ScrollBarAsNeeded)
        scroll_area.setVerticalScrollBarPolicy(Qt.ScrollBarAsNeeded)
        
        content_widget = QWidget()
        scroll_area.setWidget(content_widget)
        
        return scroll_area
    
    def create_bottom_buttons(self, layout):
        """Crear botones inferiores"""
        button_layout = QHBoxLayout()
        
        # Bot√≥n proyecto actual
        self.btn_proyecto = QPushButton("üìã Ver Proyecto Actual")
        self.btn_proyecto.setStyleSheet("""
            QPushButton {
                background-color: #0066CC;
                color: white;
                border: none;
                padding: 8px 16px;
                border-radius: 5px;
                font-weight: bold;
            }
            QPushButton:hover {
                background-color: #0052A3;
            }
        """)
        self.btn_proyecto.clicked.connect(self.mostrar_proyecto_actual)
        button_layout.addWidget(self.btn_proyecto)
        
        button_layout.addStretch()
        
        # Bot√≥n cerrar
        btn_cerrar = QPushButton("‚ùå Cerrar")
        btn_cerrar.setStyleSheet("""
            QPushButton {
                background-color: #666666;
                color: white;
                border: none;
                padding: 8px 16px;
                border-radius: 5px;
            }
            QPushButton:hover {
                background-color: #777777;
            }
        """)
        btn_cerrar.clicked.connect(self.close)
        button_layout.addWidget(btn_cerrar)
        
        layout.addLayout(button_layout)
    
    def cargar_contenido(self):
        """Cargar todo el contenido de ayuda"""
        self.cargar_inicio_rapido()
        self.cargar_gestion_contratos()
        self.cargar_generacion_documentos()
        self.cargar_facturas_directas()
        self.cargar_seguimiento()
        self.cargar_solucion_problemas()
        self.cargar_acerca_de()
    
    def cargar_inicio_rapido(self):
        """Cargar contenido de inicio r√°pido"""
        content = QLabel()
        content.setWordWrap(True)
        content.setTextFormat(Qt.RichText)
        content.setText("""
        <div style="font-family: Segoe UI; line-height: 1.6; padding: 20px;">
        
        <h1 style="color: #0066CC;">üöÄ Inicio R√°pido</h1>
        
        <h2>üìã Primeros Pasos</h2>
        <ol>
            <li><strong>Ejecutar la aplicaci√≥n</strong>: La ventana principal se abre con el splash screen ADIF</li>
            <li><strong>Interfaz principal</strong>: 5 pesta√±as organizadas (Proyecto, Facturas Directas, Resumen, Actuaciones, Configuraci√≥n)</li>
            <li><strong>Primer proyecto</strong>: Usar "Nuevo Proyecto" para comenzar</li>
            <li><strong>Estructura autom√°tica</strong>: Se crean carpetas organizadas autom√°ticamente</li>
        </ol>
        
        <h2>üñ•Ô∏è Interfaz de Usuario</h2>
        <div style="background: #F0F8FF; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <h3>Panel Principal - 5 Pesta√±as:</h3>
            <ul>
                <li><strong>üìã Proyecto</strong>: Gesti√≥n de contratos, empresas y generaci√≥n de documentos</li>
                <li><strong>üí∞ Facturas Directas</strong>: Sistema independiente para contrataci√≥n menor</li>
                <li><strong>üìä Resumen</strong>: Dashboard visual con cronogramas y estados</li>
                <li><strong>üîÑ Actuaciones</strong>: Hist√≥rico de acciones y seguimiento</li>
                <li><strong>‚öôÔ∏è Configuraci√≥n</strong>: Firmantes, plantillas y preferencias</li>
            </ul>
        </div>
        
        <h2>üìÅ Estructura de Carpetas</h2>
        <div style="background: #F5F5F5; padding: 15px; border-radius: 8px; font-family: monospace;">
            obras/[NOMBRE_PROYECTO]/<br>
            ‚îú‚îÄ‚îÄ 01-proyecto/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Documentos iniciales<br>
            ‚îú‚îÄ‚îÄ 02-documentacion-finales/ &nbsp;&nbsp;# Versiones definitivas<br>
            ‚îú‚îÄ‚îÄ 03-cartas-invitacion/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Invitaciones a empresas<br>
            ‚îú‚îÄ‚îÄ 04-ofertas-recibidas/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ofertas de licitadores<br>
            ‚îú‚îÄ‚îÄ 05-actas-adjudicacion/ &nbsp;&nbsp;&nbsp;&nbsp;# Documentos de adjudicaci√≥n<br>
            ‚îú‚îÄ‚îÄ 06-contratos/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Contratos firmados<br>
            ‚îú‚îÄ‚îÄ 07-seguimiento/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Control de ejecuci√≥n<br>
            ‚îú‚îÄ‚îÄ 08-liquidacion/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Documentos finales<br>
            ‚îî‚îÄ‚îÄ 9_Guardado_seguridad/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Respaldos autom√°ticos
        </div>
        
        <h2>‚ö° Acciones R√°pidas</h2>
        <div style="background: #E8F5E8; padding: 15px; border-radius: 8px;">
            <ul>
                <li><strong>Crear proyecto</strong>: Men√∫ ‚Üí Archivo ‚Üí Nuevo Proyecto</li>
                <li><strong>Agregar empresa</strong>: Pesta√±a Proyecto ‚Üí Tabla Empresas ‚Üí Bot√≥n +</li>
                <li><strong>Generar documento</strong>: Pesta√±a Proyecto ‚Üí Botones de generaci√≥n</li>
                <li><strong>Nueva factura directa</strong>: Pesta√±a Facturas Directas ‚Üí Nueva Factura</li>
                <li><strong>Ver seguimiento</strong>: Pesta√±a Resumen ‚Üí Dashboard visual</li>
            </ul>
        </div>
        
        <div style="background: #FFF3CD; border: 1px solid #FFC107; padding: 10px; border-radius: 5px; margin: 15px 0;">
            <strong>üí° Consejo:</strong> Utiliza siempre el bot√≥n "Guardar" despu√©s de hacer cambios importantes.
            La aplicaci√≥n hace respaldos autom√°ticos, pero es recomendable guardar manualmente.
        </div>
        
        </div>
        """)
        
        layout = QVBoxLayout()
        layout.addWidget(content)
        layout.addStretch()
        self.tab_inicio.widget().setLayout(layout)
    
    def cargar_gestion_contratos(self):
        """Cargar contenido de gesti√≥n de contratos"""
        content = QLabel()
        content.setWordWrap(True)
        content.setTextFormat(Qt.RichText)
        content.setText("""
        <div style="font-family: Segoe UI; line-height: 1.6; padding: 20px;">
        
        <h1 style="color: #0066CC;">üèóÔ∏è Gesti√≥n de Contratos</h1>
        
        <h2>üìã Crear Nuevo Contrato</h2>
        <div style="background: #F0F8FF; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <h3>Paso 1: Datos B√°sicos</h3>
            <ul>
                <li><strong>Nombre del Proyecto</strong>: T√≠tulo descriptivo (ej: "OBRAS DE REPARACI√ìN EN LAS INSTALACIONES")</li>
                <li><strong>Expediente</strong>: C√≥digo oficial (ej: "EXP-2024-001")</li>
                <li><strong>Tipo de Contrato</strong>: Obras, Servicios, o Mantenimiento</li>
                <li><strong>Presupuesto Base</strong>: Importe de licitaci√≥n (ej: 50.000,00 ‚Ç¨)</li>
                <li><strong>Plazo de Ejecuci√≥n</strong>: Duraci√≥n en d√≠as (ej: 60 d√≠as)</li>
            </ul>
        </div>
        
        <h2>üè¢ Tipos de Contrato</h2>
        <table style="border-collapse: collapse; width: 100%; margin: 10px 0;">
            <tr style="background: #E8F4FD;">
                <th style="border: 1px solid #0066CC; padding: 8px;"><strong>Tipo</strong></th>
                <th style="border: 1px solid #0066CC; padding: 8px;"><strong>Descripci√≥n</strong></th>
                <th style="border: 1px solid #0066CC; padding: 8px;"><strong>L√≠mite</strong></th>
            </tr>
            <tr>
                <td style="border: 1px solid #0066CC; padding: 8px;">üèóÔ∏è <strong>Obras</strong></td>
                <td style="border: 1px solid #0066CC; padding: 8px;">Construcci√≥n, reformas, reparaciones</td>
                <td style="border: 1px solid #0066CC; padding: 8px;">‚â§ 15.000 ‚Ç¨ (directa)</td>
            </tr>
            <tr>
                <td style="border: 1px solid #0066CC; padding: 8px;">üîß <strong>Servicios</strong></td>
                <td style="border: 1px solid #0066CC; padding: 8px;">Mantenimiento, servicios t√©cnicos</td>
                <td style="border: 1px solid #0066CC; padding: 8px;">‚â§ 40.000 ‚Ç¨ (directa)</td>
            </tr>
            <tr>
                <td style="border: 1px solid #0066CC; padding: 8px;">‚ö° <strong>Mantenimiento</strong></td>
                <td style="border: 1px solid #0066CC; padding: 8px;">Mantenimiento especializado</td>
                <td style="border: 1px solid #0066CC; padding: 8px;">Sin l√≠mite espec√≠fico</td>
            </tr>
        </table>
        
        <h2>üë• Gesti√≥n de Empresas y Ofertas</h2>
        <div style="background: #F8F9FA; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <h3>Agregar Empresas Licitadoras:</h3>
            <ol>
                <li><strong>Ir a Pesta√±a "Proyecto"</strong></li>
                <li><strong>Localizar Tabla "Empresas"</strong></li>
                <li><strong>Clic en bot√≥n "+" (Agregar)</strong></li>
                <li><strong>Completar datos obligatorios</strong>:
                    <ul>
                        <li>Nombre de la empresa</li>
                        <li>NIF/CIF (se valida formato)</li>
                        <li>Email de contacto</li>
                        <li>Persona de contacto</li>
                    </ul>
                </li>
                <li><strong>Guardar</strong>: Los datos se sincronizan autom√°ticamente</li>
            </ol>
        </div>
        
        <div style="background: #E8F5E8; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <h3>Control de Ofertas Autom√°tico:</h3>
            <ul>
                <li><strong>Sincronizaci√≥n</strong>: Al agregar empresa, aparece autom√°ticamente en tabla de ofertas</li>
                <li><strong>Validaci√≥n</strong>: Los importes se validan como n√∫meros v√°lidos</li>
                <li><strong>Comparaci√≥n</strong>: Ordenamiento autom√°tico por importe (menor a mayor)</li>
                <li><strong>Estado</strong>: Control de ofertas presentadas, adjudicadas, rechazadas</li>
            </ul>
        </div>
        
        <h2>üìä Estados del Contrato</h2>
        <div style="background: #FFF3CD; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <ul>
                <li><strong>üü° En Licitaci√≥n</strong>: Proceso de invitaci√≥n a empresas</li>
                <li><strong>üü† Evaluando Ofertas</strong>: An√°lisis de propuestas recibidas</li>
                <li><strong>üü¢ Adjudicado</strong>: Empresa seleccionada, contrato en preparaci√≥n</li>
                <li><strong>üîµ En Ejecuci√≥n</strong>: Trabajos en curso</li>
                <li><strong>‚úÖ Finalizado</strong>: Trabajos completados satisfactoriamente</li>
                <li><strong>üí∞ Liquidado</strong>: Proceso econ√≥mico cerrado</li>
            </ul>
        </div>
        
        <div style="background: #D1ECF1; border: 1px solid #17A2B8; padding: 10px; border-radius: 5px; margin: 15px 0;">
            <strong>üí° Consejo Avanzado:</strong> Utiliza el sistema de seguimiento en la pesta√±a "Resumen" 
            para tener una visi√≥n completa del estado de todos tus contratos.
        </div>
        
        </div>
        """)
        
        layout = QVBoxLayout()
        layout.addWidget(content)
        layout.addStretch()
        self.tab_contratos.widget().setLayout(layout)
    
    def cargar_generacion_documentos(self):
        """Cargar contenido de generaci√≥n de documentos"""
        content = QLabel()
        content.setWordWrap(True)
        content.setTextFormat(Qt.RichText)
        content.setText("""
        <div style="font-family: Segoe UI; line-height: 1.6; padding: 20px;">
        
        <h1 style="color: #0066CC;">üìÑ Generaci√≥n de Documentos</h1>
        
        <h2>üéØ Proceso de Generaci√≥n</h2>
        <div style="background: #F0F8FF; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <ol>
                <li><strong>Completar datos</strong> del contrato (nombre, expediente, presupuesto)</li>
                <li><strong>Agregar empresas</strong> participantes con sus ofertas</li>
                <li><strong>Seleccionar documento</strong> a generar seg√∫n la fase del proyecto</li>
                <li><strong>Clic en bot√≥n</strong> correspondiente en la pesta√±a "Proyecto"</li>
                <li><strong>Validaci√≥n autom√°tica</strong>: El sistema verifica que todos los datos necesarios est√©n completos</li>
                <li><strong>Generaci√≥n autom√°tica</strong>: Se crea el documento Word (.docx)</li>
                <li><strong>Conversi√≥n a PDF</strong>: Si est√° disponible, tambi√©n genera PDF</li>
                <li><strong>Guardado autom√°tico</strong>: Se almacena en la carpeta correspondiente</li>
            </ol>
        </div>
        
        <h2>üìã Documentos por Fase del Proyecto</h2>
        
        <h3>üîÑ FASE DE LICITACI√ìN</h3>
        <div style="background: #FFF8DC; padding: 10px; border-radius: 5px; margin: 10px 0;">
            <strong>üìß Cartas de Invitaci√≥n</strong><br>
            <em>Cu√°ndo usar</em>: Al inicio del proceso de licitaci√≥n<br>
            <em>Se genera</em>: Una carta por cada empresa invitada<br>
            <em>Ubicaci√≥n</em>: <code>03-cartas-invitacion/</code>
        </div>
        
        <h3>üìã FASE DE ADJUDICACI√ìN</h3>
        <div style="background: #F0FFF0; padding: 10px; border-radius: 5px; margin: 10px 0;">
            <strong>üìã Acta de Adjudicaci√≥n</strong><br>
            <em>Cu√°ndo usar</em>: Tras evaluar todas las ofertas y seleccionar ganadora<br>
            <em>Se genera</em>: Documento oficial de adjudicaci√≥n<br>
            <em>Ubicaci√≥n</em>: <code>05-actas-adjudicacion/</code><br><br>
            
            <strong>‚úâÔ∏è Cartas de Adjudicaci√≥n</strong><br>
            <em>Cu√°ndo usar</em>: Para comunicar resultado a todas las empresas<br>
            <em>Se genera</em>: Carta de adjudicaci√≥n (ganadora) + Cartas de no adjudicaci√≥n (resto)<br>
            <em>Ubicaci√≥n</em>: <code>05-actas-adjudicacion/</code>
        </div>
        
        <h3>üèóÔ∏è FASE DE EJECUCI√ìN</h3>
        <div style="background: #E6F3FF; padding: 10px; border-radius: 5px; margin: 10px 0;">
            <strong>üü¢ Acta de Inicio</strong><br>
            <em>Cu√°ndo usar</em>: Al comenzar f√≠sicamente los trabajos<br>
            <em>Ubicaci√≥n</em>: <code>07-seguimiento/</code><br><br>
            
            <strong>üìê Acta de Replanteo</strong> (solo obras)<br>
            <em>Cu√°ndo usar</em>: Para obras que requieren replanteo t√©cnico<br>
            <em>Ubicaci√≥n</em>: <code>07-seguimiento/</code><br><br>
            
            <strong>üë∑ Nombramiento Director</strong><br>
            <em>Cu√°ndo usar</em>: Para obras complejas que requieren director de obra<br>
            <em>Ubicaci√≥n</em>: <code>06-contratos/</code><br><br>
            
            <strong>üìÑ Contrato Oficial</strong><br>
            <em>Cu√°ndo usar</em>: Documento contractual tras adjudicaci√≥n definitiva<br>
            <em>Ubicaci√≥n</em>: <code>06-contratos/</code>
        </div>
        
        <h3>‚úÖ FASE DE FINALIZACI√ìN</h3>
        <div style="background: #F0F8FF; padding: 10px; border-radius: 5px; margin: 10px 0;">
            <strong>‚úÖ Acta de Recepci√≥n</strong><br>
            <em>Cu√°ndo usar</em>: Al finalizar satisfactoriamente los trabajos<br>
            <em>Ubicaci√≥n</em>: <code>07-seguimiento/</code><br><br>
            
            <strong>üí∞ Acta de Liquidaci√≥n</strong><br>
            <em>Cu√°ndo usar</em>: Para el cierre econ√≥mico final del contrato<br>
            <em>Ubicaci√≥n</em>: <code>08-liquidacion/</code>
        </div>
        
        <h2>üîß Variables de Plantilla</h2>
        <div style="background: #F5F5F5; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <p>Las plantillas utilizan <strong>marcadores autom√°ticos</strong> que se reemplazan por datos reales:</p>
            <div style="font-family: monospace; background: white; padding: 10px; border-radius: 5px;">
                @nombreProyecto@ ‚Üí Nombre completo del proyecto<br>
                @expediente@ ‚Üí N√∫mero de expediente oficial<br>
                @presupuestoBase@ ‚Üí Presupuesto base (formato: 50.000,00 ‚Ç¨)<br>
                @empresaAdjudicataria@ ‚Üí Nombre de la empresa seleccionada<br>
                @importeAdjudicacion@ ‚Üí Importe de la oferta ganadora<br>
                @firmanteConforme@ ‚Üí Nombre del jefe de proyecto<br>
                @fechaContrato@ ‚Üí Fecha del contrato (dd/mm/aaaa)
            </div>
        </div>
        
        <h2>‚ö†Ô∏è Validaciones Autom√°ticas</h2>
        <div style="background: #FFE6E6; border: 1px solid #FF6B6B; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <p><strong>Antes de generar cualquier documento, el sistema verifica:</strong></p>
            <ul>
                <li>‚úÖ <strong>Datos b√°sicos completos</strong> (nombre, expediente, presupuesto)</li>
                <li>‚úÖ <strong>Empresas con ofertas v√°lidas</strong> (para documentos de adjudicaci√≥n)</li>
                <li>‚úÖ <strong>Fechas coherentes</strong> (inicio anterior a fin)</li>
                <li>‚úÖ <strong>Importes num√©ricos correctos</strong></li>
                <li>‚úÖ <strong>Firmantes configurados</strong> (men√∫ Configuraci√≥n)</li>
                <li>‚úÖ <strong>Plantillas disponibles</strong> en carpeta plantillas/</li>
            </ul>
            
            <p><strong>Si falta alg√∫n dato cr√≠tico, ver√°s un mensaje como:</strong></p>
            <div style="background: #FFF3CD; padding: 10px; border-radius: 5px; margin: 10px 0;">
                ‚ö†Ô∏è No se puede generar el documento<br>
                Faltan los siguientes datos obligatorios:<br>
                ‚Ä¢ Fecha de contrato<br>
                ‚Ä¢ Empresa adjudicataria<br>
                ‚Ä¢ Importe de adjudicaci√≥n
            </div>
        </div>
        
        </div>
        """)
        
        layout = QVBoxLayout()
        layout.addWidget(content)
        layout.addStretch()
        self.tab_documentos.widget().setLayout(layout)
    
    def cargar_facturas_directas(self):
        """Cargar contenido de facturas directas"""
        content = QLabel()
        content.setWordWrap(True)
        content.setTextFormat(Qt.RichText)
        content.setText("""
        <div style="font-family: Segoe UI; line-height: 1.6; padding: 20px;">
        
        <h1 style="color: #0066CC;">üí∞ Sistema de Facturas Directas</h1>
        
        <h2>üéØ ¬øCu√°ndo Usar Facturas Directas?</h2>
        <div style="background: #E8F5E8; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <h3>‚úÖ Casos Apropiados:</h3>
            <ul>
                <li><strong>Servicios de urgencia</strong> (reparaciones inmediatas que no pueden esperar)</li>
                <li><strong>Contrataciones menores</strong> (por debajo del umbral de licitaci√≥n)</li>
                <li><strong>Servicios especializados √∫nicos</strong> (solo una empresa puede hacerlo)</li>
                <li><strong>Trabajos de mantenimiento rutinario</strong></li>
                <li><strong>Suministros menores</strong> (materiales b√°sicos)</li>
            </ul>
        </div>
        
        <div style="background: #FFE6E6; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <h3>‚ùå No Usar Para:</h3>
            <ul>
                <li>Contratos que superen los umbrales legales</li>
                <li>Obras o servicios que requieren licitaci√≥n p√∫blica</li>
                <li>Contratos con m√∫ltiples oferentes disponibles</li>
            </ul>
        </div>
        
        <h2>üìù Crear Nueva Factura Directa</h2>
        <div style="background: #F0F8FF; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <h3>Paso 1: Acceder al Sistema</h3>
            <ol>
                <li><strong>Ir a pesta√±a "üí∞ Facturas Directas"</strong></li>
                <li><strong>Clic en "Nueva Factura"</strong></li>
                <li><strong>Se abre formulario de creaci√≥n</strong></li>
            </ol>
            
            <h3>Paso 2: Completar Datos B√°sicos</h3>
            <ul>
                <li><strong>Descripci√≥n del Servicio</strong>: Breve descripci√≥n del trabajo</li>
                <li><strong>Empresa Contratista</strong>: Nombre completo de la empresa</li>
                <li><strong>NIF/CIF</strong>: Identificaci√≥n fiscal (se valida formato)</li>
                <li><strong>Importe Sin IVA</strong>: Cantidad en euros</li>
                <li><strong>Fecha de Solicitud</strong>: Fecha actual por defecto</li>
                <li><strong>Categor√≠a</strong>: Mantenimiento, Obras, Suministros, Urgencias</li>
            </ul>
            
            <h3>Paso 3: Informaci√≥n Adicional</h3>
            <ul>
                <li><strong>Ubicaci√≥n del Trabajo</strong>: Lugar espec√≠fico donde se realizar√°</li>
                <li><strong>Plazo de Ejecuci√≥n</strong>: Tiempo estimado</li>
                <li><strong>Email de Contacto</strong>: Para comunicaciones</li>
                <li><strong>Observaciones</strong>: Detalles especiales</li>
            </ul>
        </div>
        
        <h2>üéõÔ∏è Estados de las Facturas</h2>
        <table style="border-collapse: collapse; width: 100%; margin: 10px 0;">
            <tr style="background: #E8F4FD;">
                <th style="border: 1px solid #0066CC; padding: 8px;"><strong>Estado</strong></th>
                <th style="border: 1px solid #0066CC; padding: 8px;"><strong>Descripci√≥n</strong></th>
                <th style="border: 1px solid #0066CC; padding: 8px;"><strong>Acciones Disponibles</strong></th>
            </tr>
            <tr>
                <td style="border: 1px solid #0066CC; padding: 8px;">üü¢ <strong>Activa</strong></td>
                <td style="border: 1px solid #0066CC; padding: 8px;">En proceso de ejecuci√≥n</td>
                <td style="border: 1px solid #0066CC; padding: 8px;">Editar, Cerrar, Generar Orden</td>
            </tr>
            <tr>
                <td style="border: 1px solid #0066CC; padding: 8px;">üü° <strong>Pendiente</strong></td>
                <td style="border: 1px solid #0066CC; padding: 8px;">Esperando aprobaci√≥n</td>
                <td style="border: 1px solid #0066CC; padding: 8px;">Editar, Aprobar, Rechazar</td>
            </tr>
            <tr>
                <td style="border: 1px solid #0066CC; padding: 8px;">üîµ <strong>En Ejecuci√≥n</strong></td>
                <td style="border: 1px solid #0066CC; padding: 8px;">Trabajo en curso</td>
                <td style="border: 1px solid #0066CC; padding: 8px;">Ver Progreso, Comunicar</td>
            </tr>
            <tr>
                <td style="border: 1px solid #0066CC; padding: 8px;">‚úÖ <strong>Finalizada</strong></td>
                <td style="border: 1px solid #0066CC; padding: 8px;">Completada satisfactoriamente</td>
                <td style="border: 1px solid #0066CC; padding: 8px;">Ver Resumen, Archivar</td>
            </tr>
            <tr>
                <td style="border: 1px solid #0066CC; padding: 8px;">üî¥ <strong>Anulada</strong></td>
                <td style="border: 1px solid #0066CC; padding: 8px;">Cancelada o rechazada</td>
                <td style="border: 1px solid #0066CC; padding: 8px;">Ver Motivo, Archivar</td>
            </tr>
        </table>
        
        <h2>üíº L√≠mites Autom√°ticos</h2>
        <div style="background: #FFF3CD; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <h3>üìä L√≠mites por Tipo de Servicio:</h3>
            <ul>
                <li><strong>üèóÔ∏è OBRAS</strong>: ‚â§ 40.000 ‚Ç¨ (contrataci√≥n directa)</li>
                <li><strong>üîß SERVICIOS</strong>: ‚â§ 15.000 ‚Ç¨ (contrataci√≥n directa)</li>
                <li><strong>üì¶ SUMINISTROS</strong>: ‚â§ 15.000 ‚Ç¨ (contrataci√≥n directa)</li>
                <li><strong>‚ö° URGENCIAS</strong>: ‚â§ 60.000 ‚Ç¨ (justificaci√≥n especial)</li>
            </ul>
            
            <p><strong>‚ö†Ô∏è El sistema alertar√° autom√°ticamente si se superan estos l√≠mites.</strong></p>
        </div>
        
        <h2>üîç B√∫squeda y Filtrado</h2>
        <div style="background: #F8F9FA; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <p><strong>Filtros disponibles en el dashboard:</strong></p>
            <ul>
                <li><strong>üóìÔ∏è Rango de Fechas</strong>: Filtrar por per√≠odo espec√≠fico</li>
                <li><strong>üè¢ Empresa</strong>: Ver facturas de una empresa concreta</li>
                <li><strong>üí∞ Rango de Importes</strong>: Filtrar por cantidad</li>
                <li><strong>üéØ Categor√≠a</strong>: Por tipo de servicio</li>
                <li><strong>üìç Ubicaci√≥n</strong>: Por lugar de trabajo</li>
                <li><strong>üìù Texto en Descripci√≥n</strong>: B√∫squeda por palabras clave</li>
            </ul>
        </div>
        
        <h2>üìÑ Documentos Generados</h2>
        <div style="background: #E6F3FF; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <h3>üìã Orden de Trabajo</h3>
            <p>Documento oficial que se env√≠a a la empresa con:</p>
            <ul>
                <li>Datos completos de la empresa</li>
                <li>Descripci√≥n detallada del trabajo</li>
                <li>Importe total (base + IVA)</li>
                <li>Plazo de ejecuci√≥n y fecha l√≠mite</li>
                <li>Condiciones especiales</li>
                <li>Datos del responsable ADIF</li>
            </ul>
            
            <h3>üìã Justificaci√≥n de Contrataci√≥n Directa</h3>
            <p>Documento interno que incluye:</p>
            <ul>
                <li>Motivo de urgencia o especializaci√≥n</li>
                <li>Justificaci√≥n legal aplicable</li>
                <li>Verificaci√≥n de l√≠mites respetados</li>
                <li>Autorizaci√≥n del responsable</li>
            </ul>
        </div>
        
        </div>
        """)
        
        layout = QVBoxLayout()
        layout.addWidget(content)
        layout.addStretch()
        self.tab_facturas.widget().setLayout(layout)
    
    def cargar_seguimiento(self):
        """Cargar contenido de seguimiento"""
        content = QLabel()
        content.setWordWrap(True)
        content.setTextFormat(Qt.RichText)
        content.setText("""
        <div style="font-family: Segoe UI; line-height: 1.6; padding: 20px;">
        
        <h1 style="color: #0066CC;">üìä Sistema de Seguimiento</h1>
        
        <h2>üìà Dashboard Principal</h2>
        <div style="background: #F0F8FF; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <p><strong>La pesta√±a "üìä Resumen" proporciona una vista completa del estado de tus proyectos:</strong></p>
            <ul>
                <li><strong>Cronograma Visual</strong>: Timeline con todas las fases del proyecto</li>
                <li><strong>Estados en Tiempo Real</strong>: Indicadores de progreso actualizados</li>
                <li><strong>Tabla de Seguimiento</strong>: Control detallado de documentos y fechas</li>
                <li><strong>Historial de Acciones</strong>: Registro de todas las actividades</li>
            </ul>
        </div>
        
        <h2>üéØ Cronograma Visual</h2>
        <div style="background: #F8F9FA; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <h3>Fases del Proyecto:</h3>
            <div style="font-family: monospace; background: white; padding: 15px; border-radius: 5px;">
                üìã LICITACI√ìN    ‚Üí  üìä EVALUACI√ìN  ‚Üí  üèÜ ADJUDICACI√ìN<br>
                     ‚Üì                    ‚Üì                    ‚Üì<br>
                üèóÔ∏è EJECUCI√ìN     ‚Üí  ‚úÖ RECEPCI√ìN   ‚Üí  üí∞ LIQUIDACI√ìN
            </div>
            
            <p><strong>Cada fase incluye:</strong></p>
            <ul>
                <li><strong>Fecha de inicio y fin</strong> estimada y real</li>
                <li><strong>Estado actual</strong> (completada, en progreso, pendiente)</li>
                <li><strong>Documentos asociados</strong> y su estado de generaci√≥n</li>
                <li><strong>Responsable</strong> de cada fase</li>
            </ul>
        </div>
        
        <h2>üìã Tabla de Seguimiento</h2>
        <div style="background: #E8F5E8; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <h3>Informaci√≥n Detallada por Documento:</h3>
            <table style="border-collapse: collapse; width: 100%; margin: 10px 0;">
                <tr style="background: #E8F4FD;">
                    <th style="border: 1px solid #0066CC; padding: 8px;"><strong>Documento</strong></th>
                    <th style="border: 1px solid #0066CC; padding: 8px;"><strong>Estado</strong></th>
                    <th style="border: 1px solid #0066CC; padding: 8px;"><strong>Fecha</strong></th>
                    <th style="border: 1px solid #0066CC; padding: 8px;"><strong>Acci√≥n</strong></th>
                </tr>
                <tr>
                    <td style="border: 1px solid #0066CC; padding: 8px;">Cartas Invitaci√≥n</td>
                    <td style="border: 1px solid #0066CC; padding: 8px;">‚úÖ Generado</td>
                    <td style="border: 1px solid #0066CC; padding: 8px;">15/03/2024</td>
                    <td style="border: 1px solid #0066CC; padding: 8px;">üëÅÔ∏è Ver | üìß Enviar</td>
                </tr>
                <tr>
                    <td style="border: 1px solid #0066CC; padding: 8px;">Acta Adjudicaci√≥n</td>
                    <td style="border: 1px solid #0066CC; padding: 8px;">üü° Pendiente</td>
                    <td style="border: 1px solid #0066CC; padding: 8px;">-</td>
                    <td style="border: 1px solid #0066CC; padding: 8px;">üîß Generar</td>
                </tr>
                <tr>
                    <td style="border: 1px solid #0066CC; padding: 8px;">Contrato</td>
                    <td style="border: 1px solid #0066CC; padding: 8px;">‚è≥ No iniciado</td>
                    <td style="border: 1px solid #0066CC; padding: 8px;">-</td>
                    <td style="border: 1px solid #0066CC; padding: 8px;">‚è∏Ô∏è Esperando adjudicaci√≥n</td>
                </tr>
            </table>
        </div>
        
        <h2>üîÑ Historial de Actuaciones</h2>
        <div style="background: #FFF3CD; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <p><strong>La pesta√±a "üîÑ Actuaciones" registra autom√°ticamente:</strong></p>
            <ul>
                <li><strong>üìÖ Fecha y hora</strong> de cada acci√≥n</li>
                <li><strong>üë§ Usuario</strong> que realiz√≥ la acci√≥n</li>
                <li><strong>üìã Tipo de acci√≥n</strong> (creaci√≥n, modificaci√≥n, generaci√≥n de documento)</li>
                <li><strong>üìÑ Documentos afectados</strong></li>
                <li><strong>üìù Comentarios</strong> adicionales</li>
            </ul>
            
            <h3>Ejemplo de Entradas del Historial:</h3>
            <div style="font-family: monospace; background: white; padding: 10px; border-radius: 5px; margin: 10px 0;">
                15/03/2024 10:30 | Juan P√©rez | üìã Proyecto creado: "Reparaci√≥n instalaciones"<br>
                15/03/2024 11:15 | Juan P√©rez | üè¢ Empresa agregada: "ElectroServ S.L."<br>
                15/03/2024 14:20 | Juan P√©rez | üìÑ Generadas cartas de invitaci√≥n (3 empresas)<br>
                18/03/2024 09:45 | Juan P√©rez | üí∞ Oferta registrada: ElectroServ - 12.500‚Ç¨<br>
                20/03/2024 16:30 | Mar√≠a Garc√≠a | üèÜ Adjudicaci√≥n: ElectroServ S.L.
            </div>
        </div>
        
        <h2>üìä Reportes y Estad√≠sticas</h2>
        <div style="background: #E6F3FF; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <h3>Informes Disponibles:</h3>
            <ul>
                <li><strong>üìà Informe de Estado General</strong>: Resumen de todos los contratos activos</li>
                <li><strong>üí∞ Informe Econ√≥mico</strong>: An√°lisis de presupuestos vs adjudicaciones</li>
                <li><strong>üìÖ Informe de Plazos</strong>: Control de fechas l√≠mite y vencimientos</li>
                <li><strong>üè¢ Informe por Empresa</strong>: An√°lisis de adjudicaciones por contratista</li>
                <li><strong>üìã Informe de Facturas Directas</strong>: Resumen mensual de contrataci√≥n menor</li>
            </ul>
            
            <h3>Exportaci√≥n:</h3>
            <ul>
                <li><strong>üìä Excel</strong>: Todos los informes pueden exportarse a Excel</li>
                <li><strong>üìÑ PDF</strong>: Versiones imprimibles de los reportes</li>
                <li><strong>üìß Email</strong>: Env√≠o autom√°tico de informes peri√≥dicos</li>
            </ul>
        </div>
        
        <h2>üîî Alertas y Notificaciones</h2>
        <div style="background: #FFE6E6; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <h3>El sistema te alerta autom√°ticamente sobre:</h3>
            <ul>
                <li><strong>üìÖ Fechas l√≠mite pr√≥ximas</strong>: Plazos de licitaci√≥n, ejecuci√≥n, etc.</li>
                <li><strong>üìÑ Documentos pendientes</strong>: Generaciones necesarias para continuar</li>
                <li><strong>üí∞ L√≠mites econ√≥micos</strong>: Importes que se acercan a umbrales legales</li>
                <li><strong>üè¢ Concentraci√≥n de adjudicaciones</strong>: M√∫ltiples contratos a la misma empresa</li>
                <li><strong>‚è∞ Contratos sin actividad</strong>: Proyectos estancados que requieren atenci√≥n</li>
            </ul>
        </div>
        
        <div style="background: #D1ECF1; border: 1px solid #17A2B8; padding: 10px; border-radius: 5px; margin: 15px 0;">
            <strong>üí° Consejo de Productividad:</strong> Revisa el dashboard de seguimiento al menos una vez por semana 
            para mantener todos tus proyectos al d√≠a y no perder ninguna fecha importante.
        </div>
        
        </div>
        """)
        
        layout = QVBoxLayout()
        layout.addWidget(content)
        layout.addStretch()
        self.tab_seguimiento.widget().setLayout(layout)
    
    def cargar_solucion_problemas(self):
        """Cargar contenido de soluci√≥n de problemas"""
        content = QLabel()
        content.setWordWrap(True)
        content.setTextFormat(Qt.RichText)
        content.setText("""
        <div style="font-family: Segoe UI; line-height: 1.6; padding: 20px;">
        
        <h1 style="color: #0066CC;">üîß Soluci√≥n de Problemas</h1>
        
        <h2>‚ùå Problemas Comunes</h2>
        
        <h3>üìÑ Error al Generar PDF</h3>
        <div style="background: #FFE6E6; border: 1px solid #FF6B6B; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <p><strong>Mensaje:</strong> <code>Error: No se puede convertir a PDF</code></p>
            <p><strong>üîç Causas posibles:</strong></p>
            <ul>
                <li>Microsoft Word no est√° instalado</li>
                <li>Word est√° abierto con documentos sin guardar</li>
                <li>Permisos insuficientes para ejecutar Word</li>
                <li>Plantilla da√±ada o corrupta</li>
            </ul>
            <p><strong>‚úÖ Soluciones:</strong></p>
            <ol>
                <li><strong>Verificar instalaci√≥n de Word</strong>: Abrir Word manualmente</li>
                <li><strong>Cerrar todos los documentos</strong> de Word y reintentar</li>
                <li><strong>Ejecutar aplicaci√≥n como administrador</strong></li>
                <li><strong>Verificar plantillas</strong> en carpeta plantillas/</li>
                <li><strong>Generar solo Word</strong> (.docx) si el problema persiste</li>
            </ol>
        </div>
        
        <h3>üíæ Los Datos No Se Guardan</h3>
        <div style="background: #FFF3CD; border: 1px solid #FFC107; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <p><strong>Mensaje:</strong> <code>Error: No se pueden guardar los cambios</code></p>
            <p><strong>üîç Causas posibles:</strong></p>
            <ul>
                <li>Permisos de escritura insuficientes</li>
                <li>Disco lleno o sin espacio</li>
                <li>Archivo JSON bloqueado por otro proceso</li>
                <li>Ruta de guardado incorrecta</li>
            </ul>
            <p><strong>‚úÖ Soluciones:</strong></p>
            <ol>
                <li><strong>Ejecutar como administrador</strong> la aplicaci√≥n</li>
                <li><strong>Verificar espacio en disco</strong> disponible</li>
                <li><strong>Cerrar otras aplicaciones</strong> que puedan usar los archivos</li>
                <li><strong>Verificar permisos</strong> de la carpeta de instalaci√≥n</li>
                <li><strong>Cambiar ubicaci√≥n</strong> de guardado si es necesario</li>
            </ol>
        </div>
        
        <h3>üìã Plantilla No Encontrada</h3>
        <div style="background: #E6F3FF; border: 1px solid #17A2B8; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <p><strong>Mensaje:</strong> <code>Error: Plantilla no encontrada</code></p>
            <p><strong>üîç Causas posibles:</strong></p>
            <ul>
                <li>Archivos de plantilla eliminados o movidos</li>
                <li>Nombres de plantilla incorrectos</li>
                <li>Carpeta plantillas/ no existe</li>
                <li>Permisos de lectura insuficientes</li>
            </ul>
            <p><strong>‚úÖ Soluciones:</strong></p>
            <ol>
                <li><strong>Verificar carpeta plantillas/</strong> en directorio de instalaci√≥n</li>
                <li><strong>Restaurar plantillas</strong> desde respaldo o reinstalaci√≥n</li>
                <li><strong>Verificar nombres exactos</strong> de archivos de plantilla</li>
                <li><strong>Comprobar permisos de lectura</strong> en la carpeta</li>
                <li><strong>Ejecutar aplicaci√≥n desde ubicaci√≥n correcta</strong></li>
            </ol>
        </div>
        
        <h3>üè¢ Error al Agregar Empresa</h3>
        <div style="background: #F0F8FF; border: 1px solid #6C7B7F; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <p><strong>Mensaje:</strong> <code>Error: Datos de empresa inv√°lidos</code></p>
            <p><strong>üîç Causas posibles:</strong></p>
            <ul>
                <li>Formato de NIF/CIF incorrecto</li>
                <li>Email con formato inv√°lido</li>
                <li>Campos obligatorios vac√≠os</li>
                <li>Empresa duplicada</li>
            </ul>
            <p><strong>‚úÖ Soluciones:</strong></p>
            <ol>
                <li><strong>Verificar formato NIF</strong>: 12345678X o B-12345678</li>
                <li><strong>Verificar email</strong>: debe contener @ y dominio v√°lido</li>
                <li><strong>Completar todos los campos</strong> obligatorios</li>
                <li><strong>Verificar unicidad</strong>: no puede haber empresas duplicadas</li>
                <li><strong>Usar caracteres v√°lidos</strong> (evitar s√≠mbolos especiales)</li>
            </ol>
        </div>
        
        <h2>üêõ Modo Debug y Logs</h2>
        <div style="background: #F8F9FA; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <h3>üìÑ Ubicaci√≥n de Logs:</h3>
            <ul>
                <li><strong>En desarrollo</strong>: <code>app.log</code> en directorio actual</li>
                <li><strong>En EXE</strong>: <code>_internal/app.log</code> junto al ejecutable</li>
            </ul>
            
            <h3>üîç Informaci√≥n de Debug:</h3>
            <p>Los logs contienen informaci√≥n sobre:</p>
            <ul>
                <li>Errores detallados con stack traces</li>
                <li>Operaciones de guardado y carga</li>
                <li>Generaci√≥n de documentos</li>
                <li>Validaciones fallidas</li>
                <li>Estados de la aplicaci√≥n</li>
            </ul>
            
            <h3>üìß Reportar Problemas:</h3>
            <p><strong>Incluir siempre esta informaci√≥n:</strong></p>
            <ol>
                <li><strong>Descripci√≥n detallada</strong> del problema</li>
                <li><strong>Pasos exactos</strong> para reproducir el error</li>
                <li><strong>Mensaje de error completo</strong></li>
                <li><strong>Archivo de log</strong> relevante</li>
                <li><strong>Versi√≥n de la aplicaci√≥n</strong></li>
                <li><strong>Sistema operativo</strong> y versi√≥n</li>
            </ol>
        </div>
        
        <h2>‚ö° Consejos de Rendimiento</h2>
        <div style="background: #E8F5E8; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <ul>
                <li><strong>üíæ Guardar frecuentemente</strong>: Usar Ctrl+S despu√©s de cambios importantes</li>
                <li><strong>üßπ Limpiar respaldos antiguos</strong>: En carpetas 9_Guardado_seguridad/</li>
                <li><strong>üìÑ Cerrar documentos Word</strong>: Antes de generar nuevos documentos</li>
                <li><strong>üîÑ Reiniciar aplicaci√≥n</strong>: Si funciona lenta despu√©s de uso prolongado</li>
                <li><strong>üíø Mantener espacio libre</strong>: Al menos 1GB libre en disco</li>
                <li><strong>üñ•Ô∏è Cerrar otras aplicaciones</strong>: Si hay problemas de memoria</li>
            </ul>
        </div>
        
        <h2>üîÑ Recuperaci√≥n de Datos</h2>
        <div style="background: #D1ECF1; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <h3>üì¶ Respaldos Autom√°ticos:</h3>
            <p>La aplicaci√≥n crea respaldos autom√°ticos en:</p>
            <ul>
                <li><code>obras/[proyecto]/9_Guardado_seguridad/</code></li>
                <li><code>BaseDatos.json.backup_[fecha]</code></li>
            </ul>
            
            <h3>üîß Recuperar Datos Perdidos:</h3>
            <ol>
                <li><strong>Localizar respaldo</strong> m√°s reciente</li>
                <li><strong>Copiar archivo</strong> de respaldo</li>
                <li><strong>Renombrar a nombre original</strong></li>
                <li><strong>Reiniciar aplicaci√≥n</strong></li>
                <li><strong>Verificar datos restaurados</strong></li>
            </ol>
        </div>
        
        <div style="background: #D4EDDA; border: 1px solid #28A745; padding: 10px; border-radius: 5px; margin: 15px 0;">
            <strong>üí° Consejo Importante:</strong> Si ninguna soluci√≥n funciona, contacta con el soporte t√©cnico 
            proporcionando toda la informaci√≥n de debug posible. Los logs son fundamentales para resolver problemas.
        </div>
        
        </div>
        """)
        
        layout = QVBoxLayout()
        layout.addWidget(content)
        layout.addStretch()
        self.tab_problemas.widget().setLayout(layout)
    
    def cargar_acerca_de(self):
        """Cargar contenido acerca de"""
        content = QLabel()
        content.setWordWrap(True)
        content.setTextFormat(Qt.RichText)
        content.setText("""
        <div style="font-family: Segoe UI; line-height: 1.6; padding: 20px;">
        
        <h1 style="color: #0066CC;">‚ÑπÔ∏è Acerca del Generador de Actas ADIF</h1>
        
        <h2>üéØ Descripci√≥n del Sistema</h2>
        <div style="background: #F0F8FF; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <p><strong>GesConAdif</strong> es una aplicaci√≥n de escritorio desarrollada espec√≠ficamente para 
            <strong>ADIF (Administrador de Infraestructuras Ferroviarias)</strong> que automatiza la gesti√≥n 
            completa de contratos de obras y servicios, desde la licitaci√≥n hasta la liquidaci√≥n final.</p>
            
            <h3>‚ú® Caracter√≠sticas Principales:</h3>
            <ul>
                <li><strong>üèóÔ∏è Gesti√≥n integral</strong>: Control completo del ciclo de vida de contratos</li>
                <li><strong>üìÑ Generaci√≥n autom√°tica</strong>: +15 tipos de documentos oficiales</li>
                <li><strong>üí∞ Control financiero</strong>: Seguimiento de ofertas y facturaci√≥n</li>
                <li><strong>üìä Facturas directas</strong>: Sistema para contrataci√≥n menor</li>
                <li><strong>üîÑ Seguimiento visual</strong>: Dashboard con cronogramas</li>
                <li><strong>üìÅ Organizaci√≥n autom√°tica</strong>: Estructura de carpetas por proyecto</li>
                <li><strong>üíæ Respaldos autom√°ticos</strong>: Seguridad de datos garantizada</li>
                <li><strong>üñ•Ô∏è Interfaz moderna</strong>: UI intuitiva con splash screen profesional</li>
            </ul>
        </div>
        
        <h2>üìä Informaci√≥n T√©cnica</h2>
        <div style="background: #F8F9FA; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <table style="border-collapse: collapse; width: 100%;">
                <tr>
                    <td style="border: 1px solid #ccc; padding: 8px; background: #E8F4FD;"><strong>Versi√≥n Actual</strong></td>
                    <td style="border: 1px solid #ccc; padding: 8px;">3.2 (Producci√≥n)</td>
                </tr>
                <tr>
                    <td style="border: 1px solid #ccc; padding: 8px; background: #E8F4FD;"><strong>Tecnolog√≠a</strong></td>
                    <td style="border: 1px solid #ccc; padding: 8px;">Python 3.8+ con PyQt5</td>
                </tr>
                <tr>
                    <td style="border: 1px solid #ccc; padding: 8px; background: #E8F4FD;"><strong>Plataforma</strong></td>
                    <td style="border: 1px solid #ccc; padding: 8px;">Windows 10/11</td>
                </tr>
                <tr>
                    <td style="border: 1px solid #ccc; padding: 8px; background: #E8F4FD;"><strong>Base de Datos</strong></td>
                    <td style="border: 1px solid #ccc; padding: 8px;">JSON (M√°xima compatibilidad)</td>
                </tr>
                <tr>
                    <td style="border: 1px solid #ccc; padding: 8px; background: #E8F4FD;"><strong>Documentos</strong></td>
                    <td style="border: 1px solid #ccc; padding: 8px;">Microsoft Word (.docx) ‚Üí PDF</td>
                </tr>
                <tr>
                    <td style="border: 1px solid #ccc; padding: 8px; background: #E8F4FD;"><strong>L√≠neas de C√≥digo</strong></td>
                    <td style="border: 1px solid #ccc; padding: 8px;">+15.000 l√≠neas Python</td>
                </tr>
                <tr>
                    <td style="border: 1px solid #ccc; padding: 8px; background: #E8F4FD;"><strong>M√≥dulos</strong></td>
                    <td style="border: 1px solid #ccc; padding: 8px;">+50 archivos organizados</td>
                </tr>
            </table>
        </div>
        
        <h2>üë®‚Äçüíª Informaci√≥n de Desarrollo</h2>
        <div style="background: #E8F5E8; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <ul>
                <li><strong>üë§ Desarrollador</strong>: Pablo Mart√≠n Fern√°ndez</li>
                <li><strong>üéì Cargo</strong>: Ingeniero Industrial</li>
                <li><strong>üè¢ Departamento</strong>: Patrimonio y Urbanismo</li>
                <li><strong>üèõÔ∏è Organizaci√≥n</strong>: ADIF</li>
                <li><strong>üìÖ Per√≠odo de Desarrollo</strong>: 6+ meses activos</li>
                <li><strong>üîß Estado</strong>: Producci√≥n estable</li>
            </ul>
        </div>
        
        <h2>üìà Historial de Versiones</h2>
        <div style="background: #FFF3CD; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <h3>üöÄ Versi√≥n 3.2 (Actual) - Septiembre 2024</h3>
            <ul>
                <li>‚úÖ <strong>Splash screen profesional</strong> con logo ADIF</li>
                <li>‚úÖ <strong>Iconos en barra de tareas</strong> y ventanas</li>
                <li>‚úÖ <strong>Optimizaci√≥n de arranque</strong> con lazy loading</li>
                <li>‚úÖ <strong>Logs organizados</strong> en _internal/ para EXE</li>
                <li>‚úÖ <strong>Sistema de facturas directas</strong> completamente funcional</li>
                <li>‚úÖ <strong>Dashboard avanzado</strong> con estad√≠sticas</li>
                <li>‚úÖ <strong>Compilaci√≥n optimizada</strong> para distribuci√≥n</li>
                <li>‚úÖ <strong>Interfaz mejorada</strong> con tema corporativo</li>
                <li>‚úÖ <strong>Sistema de ayuda integrado</strong> (esta ventana)</li>
            </ul>
            
            <h3>üéØ Versi√≥n 3.3 (Pr√≥xima) - Q4 2024</h3>
            <ul>
                <li>üîÑ <strong>Integraci√≥n con sistemas ADIF</strong> corporativos</li>
                <li>üîÑ <strong>Notificaciones autom√°ticas</strong> por email</li>
                <li>üîÑ <strong>Dashboard ejecutivo</strong> con KPIs</li>
                <li>üîÑ <strong>API REST</strong> para integraciones externas</li>
                <li>üîÑ <strong>Workflow automatizado</strong> de aprobaciones</li>
                <li>üîÑ <strong>Firma digital</strong> integrada</li>
            </ul>
        </div>
        
        <h2>üìÑ Licencia y Uso</h2>
        <div style="background: #FFE6E6; border: 1px solid #FF6B6B; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <p><strong>Este software es propiedad de ADIF (Administrador de Infraestructuras Ferroviarias)</strong> 
            y est√° destinado exclusivamente para uso interno de la organizaci√≥n.</p>
            
            <h3>üìã Restricciones de Uso:</h3>
            <ul>
                <li>‚ùå <strong>No distribuci√≥n externa</strong>: No se permite compartir fuera de ADIF</li>
                <li>‚ùå <strong>No uso comercial por terceros</strong>: Exclusivo para operaciones internas</li>
                <li>‚ùå <strong>No modificaci√≥n sin autorizaci√≥n</strong>: Cambios requieren aprobaci√≥n</li>
                <li>‚úÖ <strong>Uso interno ADIF autorizado</strong>: Libre uso dentro de la organizaci√≥n</li>
            </ul>
        </div>
        
        <h2>üõ†Ô∏è Dependencias Principales</h2>
        <div style="background: #E6F3FF; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <ul>
                <li><strong>üêç Python 3.8+</strong>: Lenguaje de programaci√≥n principal</li>
                <li><strong>üñ•Ô∏è PyQt5 5.15+</strong>: Framework de interfaz gr√°fica</li>
                <li><strong>üìÑ python-docx</strong>: Generaci√≥n de documentos Word</li>
                <li><strong>üìä openpyxl</strong>: Manejo de archivos Excel</li>
                <li><strong>üñºÔ∏è Pillow</strong>: Procesamiento de im√°genes</li>
                <li><strong>üìã docx2pdf</strong>: Conversi√≥n a PDF</li>
                <li><strong>üß™ pytest</strong>: Framework de testing</li>
            </ul>
        </div>
        
        <h2>üìû Soporte y Contacto</h2>
        <div style="background: #D1ECF1; padding: 15px; border-radius: 8px; margin: 10px 0;">
            <p><strong>Para reportar problemas o solicitar mejoras:</strong></p>
            <ol>
                <li><strong>Descripci√≥n detallada</strong> del problema o solicitud</li>
                <li><strong>Pasos para reproducir</strong> el error (si aplica)</li>
                <li><strong>Archivos de log</strong> relevantes</li>
                <li><strong>Versi√≥n de la aplicaci√≥n</strong> (mostrada en esta ventana)</li>
                <li><strong>Capturas de pantalla</strong> si es necesario</li>
            </ol>
            
            <p><strong>üìß Contacto Interno ADIF</strong>: A trav√©s de los canales habituales de soporte t√©cnico</p>
        </div>
        
        <div style="background: #D4EDDA; border: 1px solid #28A745; padding: 10px; border-radius: 5px; margin: 15px 0;">
            <strong>üèÜ Reconocimiento:</strong> Desarrollado con ‚ù§Ô∏è para optimizar los procesos de contrataci√≥n en ADIF.
            Gracias por utilizar el Generador de Actas ADIF y contribuir a la eficiencia de nuestros procesos.
        </div>
        
        </div>
        """)
        
        layout = QVBoxLayout()
        layout.addWidget(content)
        layout.addStretch()
        self.tab_acerca.widget().setLayout(layout)
    
    def mostrar_proyecto_actual(self):
        """Mostrar informaci√≥n del proyecto actual"""
        # Obtener referencia al controlador principal
        parent_window = self.parent()
        if parent_window and hasattr(parent_window, 'proyecto_actual'):
            if parent_window.proyecto_actual and hasattr(parent_window, 'controlador_json'):
                try:
                    contract_data = parent_window.controlador_json.obtener_datos_contrato(parent_window.proyecto_actual)
                    
                    if contract_data:
                        mensaje = f"""
                        <div style="font-family: Segoe UI; line-height: 1.6; padding: 20px;">
                        <h2 style="color: #0066CC;">üìã Informaci√≥n del Proyecto Actual</h2>
                        <table style="border-collapse: collapse; width: 100%; margin: 10px 0;">
                            <tr>
                                <td style="border: 1px solid #0066CC; padding: 8px; background: #E8F4FD;"><strong>Nombre</strong></td>
                                <td style="border: 1px solid #0066CC; padding: 8px;">{contract_data.get('nombre_proyecto', 'N/A')}</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #0066CC; padding: 8px; background: #E8F4FD;"><strong>Expediente</strong></td>
                                <td style="border: 1px solid #0066CC; padding: 8px;">{contract_data.get('numero_expediente', 'N/A')}</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #0066CC; padding: 8px; background: #E8F4FD;"><strong>Tipo</strong></td>
                                <td style="border: 1px solid #0066CC; padding: 8px;">{contract_data.get('tipo_contrato', 'N/A')}</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #0066CC; padding: 8px; background: #E8F4FD;"><strong>Presupuesto</strong></td>
                                <td style="border: 1px solid #0066CC; padding: 8px;">{contract_data.get('presupuesto_licitacion', 'N/A')} ‚Ç¨</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #0066CC; padding: 8px; background: #E8F4FD;"><strong>Estado</strong></td>
                                <td style="border: 1px solid #0066CC; padding: 8px;">{contract_data.get('estado', 'N/A')}</td>
                            </tr>
                        </table>
                        </div>
                        """
                        
                        QMessageBox.information(self, "Proyecto Actual", mensaje)
                    else:
                        QMessageBox.information(self, "Proyecto Actual", "No se pudieron obtener los datos del proyecto actual.")
                        
                except Exception as e:
                    QMessageBox.warning(self, "Error", f"Error obteniendo datos del proyecto: {e}")
            else:
                QMessageBox.information(self, "Informaci√≥n", "No hay ning√∫n proyecto cargado actualmente.")
        else:
            QMessageBox.information(self, "Informaci√≥n", "No se pudo acceder a la informaci√≥n del proyecto.")